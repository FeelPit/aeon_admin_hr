#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Ngrok —Ç—É–Ω–Ω–µ–ª–µ–º

echo "üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Ngrok —Ç—É–Ω–Ω–µ–ª–µ–º..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ ngrok
if ! command -v ngrok &> /dev/null; then
    echo "‚ùå ngrok –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å https://ngrok.com/download"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ backend
echo "üì° –ü—Ä–æ–≤–µ—Ä–∫–∞ backend..."
if ! curl -s http://localhost:8001/api/health > /dev/null; then
    echo "‚ùå Backend –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8001"
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞: ./start-backend.sh"
    exit 1
fi

echo "‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç"

# –ó–∞–ø—É—Å–∫–∞–µ–º ngrok —Ç—É–Ω–Ω–µ–ª—å
echo "üåê –ó–∞–ø—É—Å–∫ Ngrok —Ç—É–Ω–Ω–µ–ª—è..."
echo "üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ URL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç Ngrok"
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º ngrok —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
ngrok http 8001 --log=stdout 